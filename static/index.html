<html>
<head>
<title>Jersey on Grizzly Spike</title>
<script type="text/javascript">
	function pageReady() { 
		console.log('Page is ready');
		var evtSource = new EventSource('/myapp/events', { withCredentials: false });
		console.log(evtSource);
		var eventList = document.querySelector('ul');
		
		evtSource.onopen = function(e) {
		    console.log("Connection to server opened.", e);
		};

		evtSource.onmessage = function(e) {
			console.log('RECEIVED', e);
			var newElement = document.createElement("li");
			newElement.textContent = "message: " + e.data;
			eventList.appendChild(newElement);
		};
		
		evtSource.onerror = function(e) {
			console.log('ERROR', e, e.target.readyState)
			evtSource.close();
		};
	}
	</script>
</head>
<body onload="pageReady()">
	<h1>Hello, Jersey!</h1>
	<p>
		From
		<code>static</code>
		!
	</p>
	<ul></ul>	
</body>
</html>